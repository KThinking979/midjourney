"use strict";(self.webpackChunkemojifi=self.webpackChunkemojifi||[]).push([[137],{1940:(e,t,r)=>{r.d(t,{M:()=>a,n:()=>n});var i=r(4451);const a=(0,i.j)((()=>r.e(465).then(r.bind(r,465))),(e=>e.ImageFast)),n=(0,i.j)((()=>r.e(919).then(r.bind(r,8919))),(e=>e.ImageSkeleton))},4137:(e,t,r)=>{r.r(t),r.d(t,{AlbumPage:()=>y});var i=r(9950),a=r(6455),n=r(3247),s=r(1389),o=r(4418),l=r(5890),c=r(5439),d=r(1374),h=r(1317),p=r(194),m=r(8671),u=r(1878),x=r(5236),g=r(712),w=r(7385),f=r(327),v=r(6256),j=r(1940),S=r(4414);let b=window.innerWidth>500?500:window.innerWidth;window.innerHeight;const y=()=>{const{configs:e,user:t}=(0,i.useContext)(x.rf),{setConfigs:r,setUser:y}=(0,i.useContext)(x.D8),[k,C]=(0,i.useState)(!0),[_,L]=(0,i.useState)(!1),[A,F]=(0,i.useState)(!0),[z,H]=(0,i.useState)(0),[I,P]=(0,i.useState)([]),[W,E]=(0,i.useState)("All"),K=async t=>{let{isFirst:r,_textKey:i,_cursor:a}=t;if(!_&&a<=e.limitSearch){L(!0);let t=await(0,g.FH)({server:e&&e.lexicaSearch?e.lexicaSearch:"https://lexica.art/api/infinite-prompts",model:e&&e.modelLexica?e.modelLexica:"lexica-aperture-v2",text:i,cursor:a});if(t&&t.prompts&&0===t.prompts.length&&(t=await(0,g.FH)({server:e&&e.lexicaSearch?e.lexicaSearch:"https://lexica.art/api/infinite-prompts",model:e&&e.modelLexica?e.modelLexica:"lexica-aperture-v2",text:i,cursor:a})),t&&t.prompts&&0===t.prompts.length&&(t=await(0,g.FH)({server:e&&e.lexicaSearch?e.lexicaSearch:"https://lexica.art/api/infinite-prompts",model:e&&e.modelLexica?e.modelLexica:"lexica-aperture-v2",text:i,cursor:a})),t&&t.prompts&&0===t.prompts.length&&(t=await(0,g.FH)({server:e&&e.lexicaSearch?e.lexicaSearch:"https://lexica.art/api/infinite-prompts",model:e&&e.modelLexica?e.modelLexica:"lexica-aperture-v2",text:i,cursor:a})),t&&t.prompts&&t.prompts.length){const{prompts:r}=t,i=[];for(let t=0;t<r.length;t++){const a=r[t];i.push({id:a.id,textKey:a.prompt,negativeKey:a.negativePrompt?a.negativePrompt:"",uri:a.images.length?"".concat(e.lexicaImageSm2,"/").concat(a.images[0].id):"",width:a.width,height:a.height,isLast:t===r.length-1?I.length+r.length:0})}P([...I,...i]),H(a+50),a+50===e.limitSearch&&F(!1)}else P([]);!k&&await(0,w.yy)(1e3),L(!1)}};(0,i.useEffect)((()=>{(async()=>{if(!e){const e=await(0,g.Y_)();r(e)}await K({isFirst:!1,_textKey:"",_cursor:0}),window.scrollTo(0,0)})(),(async()=>{var e;const r=null===(e=window.Telegram)||void 0===e?void 0:e.WebApp;if(r&&!t){r.ready();const e=r.initDataUnsafe.user;if(e){let t={id:e.id,username:"".concat(e.last_name," ").concat(e.first_name),coins:0};const r=await(0,g.wz)(t.id);r?t={...r,username:"".concat(e.last_name," ").concat(e.first_name)}:await(0,g.kg)(t),y(t)}}})()}),[]);const M=(0,i.useCallback)((async()=>{const{scrollTop:e,scrollHeight:t,clientHeight:r}=document.documentElement;e+r>=t-.5&&await K({isFirst:!1,_textKey:"",_cursor:0})}),[I]);return(0,i.useEffect)((()=>(window.addEventListener("scroll",M),()=>window.removeEventListener("scroll",M))),[M]),(0,S.jsxs)(n.az,{children:[(0,S.jsxs)(a.mg,{children:[(0,S.jsx)("title",{children:"Album"}),(0,S.jsx)("meta",{name:"description",content:"Midjourney AI"})]}),(0,S.jsxs)(s.B,{h:"100vh",w:b,py:16,px:2,spacing:4,children:[(0,S.jsx)(s.B,{children:(0,S.jsx)(o.z,{pos:"fixed",zIndex:999,right:2,children:(0,S.jsxs)(l.W,{children:[(0,S.jsx)(c.I,{variant:"outline",borderRadius:"full",borderColor:"purple.400",borderWidth:1,as:d.$,rightIcon:(0,S.jsx)(f.gpS,{color:"white",size:18}),size:"sm",minW:20,_focus:{bg:"transparent"},_hover:{bg:"transparent"},_expanded:{bg:"transparent"},children:(0,S.jsx)(h.E,{color:"white",fontSize:14,fontWeight:"700",children:W})}),(0,S.jsx)(p.c,{backgroundColor:"gray.800",borderColor:"gray.800",color:"white",children:(0,S.jsxs)(m.i,{defaultValue:"All",type:"radio",onChange:e=>{E(e)},children:[(0,S.jsx)(u.k,{backgroundColor:"transparent",value:"All",children:"All"}),(0,S.jsx)(u.k,{backgroundColor:"transparent",value:"Photos",children:"Photos"}),(0,S.jsx)(u.k,{backgroundColor:"transparent",value:"Videos",children:"Videos"})]})})]})})}),(0,S.jsx)(s.B,{padding:0,pb:40,pt:6,onScroll:M,children:(0,S.jsx)(v.A,{columnsCount:2,gutter:"16px",children:I.map(((e,t)=>{const{id:r,uri:i}=e;return(0,S.jsx)(j.M,{uri:i},t)}))})})]})]})}},7385:(e,t,r)=>{r.d(t,{RZ:()=>a,Sk:()=>n,yy:()=>i});const i=e=>new Promise((t=>setTimeout(t,e))),a=e=>{let{min:t,max:r}=e;return Math.floor(Math.random()*(r-t+1))+t},n=e=>new Promise(((t,r)=>{const i=new FileReader;i.onloadend=()=>t(i.result),i.readAsDataURL(e)}))}}]);