"use strict";(self.webpackChunkemojifi=self.webpackChunkemojifi||[]).push([[176],{1940:(e,t,s)=>{s.d(t,{Kc:()=>n,MF:()=>a,nn:()=>r});var i=s(4451);const a=(0,i.j)((()=>s.e(465).then(s.bind(s,465))),(e=>e.ImageFast)),r=(0,i.j)((()=>s.e(9606).then(s.bind(s,9606))),(e=>e.ImageSkeleton)),n=(0,i.j)((()=>s.e(2613).then(s.bind(s,2613))),(e=>e.ImageSkeletonShow))},176:(e,t,s)=>{s.r(t),s.d(t,{ModalGenArt:()=>z});var i=s(9950),a=s(2099),r=s(4521),n=s(2463),o=s(2505),c=s(4787),l=s(3247),d=s(4418),h=s(393),u=s(1317),p=s(6569),g=s(1389),x=s(2481),w=s(1374),f=s(5236),m=s(3246),y=s(1940),j=s(5495),v=s(712),S=s(4456),k=s(9591),b=s(7385),C=s(3124),I=s(7956),K=s(2096),F=s(4414);let O=window.innerWidth>500?500:window.innerWidth,_=!1;const z=e=>{let{isOpen:t,onClose:z,dataAI:E}=e;const N=(0,a.d)(),{user:P,configs:T}=(0,i.useContext)(f.rf),{setUser:A}=(0,i.useContext)(f.D8),[W,B]=(0,i.useState)(!1),[R,D]=(0,i.useState)(!1),[G,H]=(0,i.useState)(!1),[Q,U]=(0,i.useState)(!1),[L,V]=(0,i.useState)(),[$,M]=(0,i.useState)(""),[Y,Z]=(0,i.useState)(""),[q,J]=(0,i.useState)(""),[X,ee]=(0,i.useState)(""),[te,se]=(0,i.useState)("");(0,i.useEffect)((()=>{window.scrollTo(0,0),P&&E&&ie({isFree:E.isFree})}),[E]);const ie=async e=>{let t,{isFree:s}=e;_=!1;let i=0;try{if(P&&E){const e=P;B(!0),D(!1),V(E),M(""),Z(""),J(""),ee(""),se("");const a=E.style?E.style.key:"";let r="".concat(a.replace("{prompt}",E.prompt));const n=E.style?E.style.negativeKey:"",o="".concat(E.negativeKey," ").concat(n);if((s||!s&&parseFloat(e.coins)>=parseFloat(E.feeCoin))&&E.type===S.Wk.GEN)for(let s=0;s<E.samples&&!_;s++){let e=E.seed;if(-1===E.seed&&(e=(0,b.RZ)({min:0,max:S.Vm})),E.type===S.Wk.GEN&&"ProGen"===E.model){const s={...E,stylePreset:E.style.stylePreset,seed:e,textKey:r,negativeKey:o,token:T.token,server:T.server};t=E.isText?await(0,v.F)(s):await(0,v.fO)(s),!t.error&&t.isSuccess||(await(0,b.yy)(1e3),t=E.isText?await(0,v.F)(s):await(0,v.fO)(s)),!t.error&&t.isSuccess||(await(0,b.yy)(1e3),t=E.isText?await(0,v.F)(s):await(0,v.fO)(s)),!t.error&&t.isSuccess||(await(0,b.yy)(1e3),t=E.isText?await(0,v.F)(s):await(0,v.fO)(s)),!t.error&&t.isSuccess||(await(0,b.yy)(1e3),t=E.isText?await(0,v.Ip)({...E,seed:e,steps:20*E.steps/30,width:E.width,height:E.height,model:"dreamshaper_8_93211.safetensors",textKey:r,negativeKey:o,isHD:!0,token:T.tokenNov,server:T.serverNov}):await(0,v.Ip)({...E,base64:"",seed:e,steps:20*E.steps/30,width:E.width,height:E.height,model:"dreamshaper_8_93211.safetensors",textKey:r,negativeKey:o,isHD:!0,token:T.tokenNov,server:T.serverNov})),!t.error&&t.isSuccess||(await(0,b.yy)(1e3),E.isText,t=await(0,v.Ip)({...E,seed:e,steps:20*E.steps/30,width:E.width,height:E.height,model:"dreamshaper_8_93211.safetensors",textKey:r,negativeKey:o,isHD:!0,token:T.tokenNov,server:T.serverNov}))}if(E.type===S.Wk.GEN&&"ProGen"!==E.model){const s={...E,seed:e,steps:20*E.steps/30,width:E.width,height:E.height,textKey:r,negativeKey:o,token:T.tokenNov,server:T.serverNov};t=E.isText?await(0,v.Ip)(s):await(0,v.EQ)(s),!t.error&&t.isSuccess||(await(0,b.yy)(1e3),t=E.isText?await(0,v.Ip)(s):await(0,v.EQ)(s)),!t.error&&t.isSuccess||(await(0,b.yy)(1e3),t=E.isText?await(0,v.Ip)(s):await(0,v.EQ)(s)),!t.error&&t.isSuccess||(await(0,b.yy)(1e3),t=E.isText?await(0,v.Ip)(s):await(0,v.EQ)(s))}if(t&&!t.error){if(0===s&&M(t.data),4===E.samples)switch(s){case 0:Z(t.data);break;case 1:J(t.data);break;case 2:ee(t.data);break;case 3:se(t.data)}t.isSuccess&&(i+=parseFloat(E.feeCoin)/E.samples)}}if(B(!1),s){const e=(new Date).toUTCString(),t="".concat(P.dateAds,"_").concat(E.mode,"_ADS_V1_").concat(e);(0,v.TK)({id:P.id,updatedAt:t})}else{const t=parseFloat(e.coins)-i,s=(new Date).toUTCString(),a="".concat(e.coins,"-").concat(i,"=").concat(t,"_Gen_V1_IOS_").concat(s);null===t&&void 0===t||(await(0,v.TK)({id:P.id,coins:t<0?0:t,updatedAt:a}),A({...P,coins:t<0?0:t}))}D(!0)}else z&&z()}catch(a){console.log("Error ",a),B(!1)}},ae=(0,i.useCallback)((async()=>{P&&(parseFloat(P.coins)>=parseFloat(L.feeCoin)?ie({isFree:!1}):H(!0))}),[P,L]),re=(0,i.useCallback)((async()=>{if(P)try{B(!0);const e=(0,I.A)(),t=await(0,v.jH)({data:$,folder:"albums",name:e,isUrl:!!$.includes("http")}),s={id:e,type:L.type,isImage:!0,prompt:L.prompt,negative:L.negative,style:L.style.title,width:L.width,height:L.height,steps:L.steps,scale:L.scale,uri:t};await(0,v.Y4)({id:P.id,data:s}),N({title:"Saved",status:"success",position:"top",isClosable:!0}),B(!1)}catch(e){B(!1)}}),[L,$]),ne=O;return(0,F.jsxs)(r.aF,{onClose:z,isOpen:t,size:"full",children:[(0,F.jsx)(n.m,{}),(0,F.jsx)(o.$,{backgroundColor:"black",zIndex:9999,children:(0,F.jsxs)(c.c,{p:0,children:[(0,F.jsx)(l.az,{transition:"0.9s ease",pos:"fixed",top:0,w:"full",zIndex:999,children:(0,F.jsxs)(d.z,{flex:1,p:2,justifyContent:"space-between",w:"full",minH:"40px",children:[(0,F.jsx)(h.I,{as:K.m6W,boxSize:7,padding:0,color:"white",zIndex:999,onClick:()=>{z&&z()}}),(0,F.jsxs)(d.z,{alignItems:"center",justifyContent:"center",children:[(0,F.jsx)(u.E,{fontSize:"18px",fontWeight:500,lineHeight:"17px",letterSpacing:"0.5px",color:"white",textAlign:"center",children:P&&P.coins?(new Intl.NumberFormat).format(P.coins):0}),(0,F.jsx)(p._,{borderRadius:"full",boxSize:"20px",src:s(2975),alt:"coin"})]})]})}),(0,F.jsxs)(g.B,{h:"100vh",w:O,pt:20,px:2,justifyContent:"space-between",children:[(0,F.jsxs)(g.B,{flex:1,children:[L&&1===L.samples&&(0,F.jsx)(g.B,{flex:1,justifyContent:"center",children:(0,F.jsx)(y.Kc,{uri:$,width:O,height:O/(L.width/L.height)},$)}),L&&4===L.samples&&!R&&(0,F.jsx)(g.B,{flex:1,justifyContent:"center",children:(0,F.jsxs)(x.x,{templateColumns:"repeat(2, 1fr)",gap:6,children:[(0,F.jsx)(y.Kc,{uri:Y,width:ne/2,height:ne/(L.width/L.height)/2},1),(0,F.jsx)(y.Kc,{uri:q,width:ne/2,height:ne/(L.width/L.height)/2},2),(0,F.jsx)(y.Kc,{uri:X,width:ne/2,height:ne/(L.width/L.height)/2},3),(0,F.jsx)(y.Kc,{uri:te,width:ne/2,height:ne/(L.width/L.height)/2},4)]})}),L&&4===L.samples&&R&&(0,F.jsx)(g.B,{flex:1,justifyContent:"center",children:(0,F.jsxs)(d.z,{spacing:1,children:[(0,F.jsx)(g.B,{w:"10%",children:(0,F.jsxs)(x.x,{templateColumns:"repeat(1, 1fr)",gap:6,children:[(0,F.jsx)(y.Kc,{isActive:$===Y,uri:Y,width:.2*ne/2,height:.2*ne/(L.width/L.height)/2,onPress:()=>{M(Y)}},1),(0,F.jsx)(y.Kc,{isActive:$===q,uri:q,width:.2*ne/2,height:.2*ne/(L.width/L.height)/2,onPress:()=>{M(q)}},2),(0,F.jsx)(y.Kc,{isActive:$===X,uri:X,width:.2*ne/2,height:.2*ne/(L.width/L.height)/2,onPress:()=>{M(X)}},3),(0,F.jsx)(y.Kc,{isActive:$===te,uri:te,width:.2*ne/2,height:.2*ne/(L.width/L.height)/2,onPress:()=>{M(te)}},4)]})}),(0,F.jsx)(g.B,{w:"90%",children:(0,F.jsx)(y.Kc,{uri:$,width:.8*ne,height:.8*ne/(L.width/L.height)},$)})]})})]}),(0,F.jsx)(g.B,{spacing:4,justifyContent:"center",w:"full",backgroundColor:"black",maxW:"500px",children:(0,F.jsxs)(d.z,{spacing:2,children:[(0,F.jsx)(w.$,{py:4,my:4,colorScheme:"purple",borderRadius:"full",onClick:ae,leftIcon:(0,F.jsx)(h.I,{as:k.aO_}),flex:1,children:(0,F.jsx)(d.z,{children:(0,F.jsx)(u.E,{color:"white",fontSize:16,fontWeight:"700",children:"Re-Create"})})}),(0,F.jsx)(w.$,{flex:1,py:4,mx:2,my:4,colorScheme:"blue",borderRadius:"full",onClick:re,leftIcon:(0,F.jsx)(h.I,{as:j.gWm}),children:(0,F.jsx)(d.z,{children:(0,F.jsx)(u.E,{color:"white",fontSize:16,fontWeight:"700",children:"Save"})})})]})})]}),(0,F.jsx)(C.s,{isOpen:G,onClose:()=>H(!G),onPressPay:()=>{H(!1),U(!0)},onPressAds:()=>{H(!1),ie({isFree:!0})}}),(0,F.jsx)(m.QV,{isOpen:Q,onClose:()=>{U(!1)}}),(0,F.jsx)(m.aj,{isOpen:W})]})})]})}},3124:(e,t,s)=>{s.d(t,{s:()=>i});const i=(0,s(4451).j)((()=>Promise.all([s.e(8524),s.e(327),s.e(712),s.e(897)]).then(s.bind(s,897))),(e=>e.SlideAds))},2975:(e,t,s)=>{e.exports=s.p+"static/media/coin.84cf06a861a4cfb9ad42.png"},6569:(e,t,s)=>{s.d(t,{_:()=>l});var i=s(8039),a=s(4414),r=(0,i.R)((function(e,t){const{htmlWidth:s,htmlHeight:i,alt:r,...n}=e;return(0,a.jsx)("img",{width:s,height:i,ref:t,alt:r,...n})}));r.displayName="NativeImage";var n=s(5812),o=s(6306);function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const s=Object.assign({},e);for(const i of t)i in s&&delete s[i];return s}var l=(0,i.R)((function(e,t){const{fallbackSrc:s,fallback:i,src:l,srcSet:d,align:h,fit:u,loading:p,ignoreFallback:g,crossOrigin:x,fallbackStrategy:w="beforeLoadOrError",referrerPolicy:f,...m}=e,y=null!=p||g||!(void 0!==s||void 0!==i),j=(0,n.l)({...e,crossOrigin:x,ignoreFallback:y}),v=(0,n.m)(j,w),S={ref:t,objectFit:u,objectPosition:h,...y?m:c(m,["onError","onLoad"])};return v?i||(0,a.jsx)(o.B.img,{as:r,className:"chakra-image__placeholder",src:s,...S}):(0,a.jsx)(o.B.img,{as:r,src:l,srcSet:d,crossOrigin:x,loading:p,referrerPolicy:f,className:"chakra-image",...S})}));l.displayName="Image"},5812:(e,t,s)=>{s.d(t,{l:()=>r,m:()=>n});var i=s(1792),a=s(9950);function r(e){const{loading:t,src:s,srcSet:r,onLoad:n,onError:o,crossOrigin:c,sizes:l,ignoreFallback:d}=e,[h,u]=(0,a.useState)("pending");(0,a.useEffect)((()=>{u(s?"loading":"pending")}),[s]);const p=(0,a.useRef)(),g=(0,a.useCallback)((()=>{if(!s)return;x();const e=new Image;e.src=s,c&&(e.crossOrigin=c),r&&(e.srcset=r),l&&(e.sizes=l),t&&(e.loading=t),e.onload=e=>{x(),u("loaded"),null==n||n(e)},e.onerror=e=>{x(),u("failed"),null==o||o(e)},p.current=e}),[s,c,r,l,n,o,t]),x=()=>{p.current&&(p.current.onload=null,p.current.onerror=null,p.current=null)};return(0,i.U)((()=>{if(!d)return"loading"===h&&g(),()=>{x()}}),[h,g,d]),d?"loaded":h}var n=(e,t)=>"loaded"!==e&&"beforeLoadOrError"===t||"failed"===e&&"onError"===t}}]);