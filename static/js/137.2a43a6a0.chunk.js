"use strict";(self.webpackChunkemojifi=self.webpackChunkemojifi||[]).push([[137],{712:(e,t,a)=>{a.d(t,{kg:()=>c,Y_:()=>i,wz:()=>p,FH:()=>u,bF:()=>l,TK:()=>d});var r=a(6220);const n=(0,a(815).Wp)({apiKey:"AIzaSyBOTVOdSu20rXHX_VWHnV3XmS9ZcnfQuBQ",authDomain:"midjourneyai-71161.firebaseapp.com",projectId:"midjourneyai-71161",storageBucket:"midjourneyai-71161.appspot.com",messagingSenderId:"559017193613",appId:"1:559017193613:web:8f4159f592c0a63e4e32c4",measurementId:"G-FEN6H6F61Y"}),s=(0,r.aU)(n);var o=a(4456);const i=async()=>{try{let e;const t=(0,r.H9)(s,"configs","configs"),a=await(0,r.x7)(t);return a.exists()&&(e=a.data()),e}catch(e){console.error("Error getUser: ",e)}},c=async e=>{let{id:t,username:a,coins:n}=e;try{const e=(new Date).toISOString().slice(0,10).replace("-","").replace("-","");await(0,r.BN)((0,r.H9)(s,"users","".concat(t)),{id:"".concat(t),username:a,coins:n,numAds:1,expDateAds:e,language:"en",createdAt:new Date,updateAt:new Date})}catch(o){console.error("Error createUser: ",o)}},l=async e=>{let{id:t,coins:a,transactionId:n}=e;try{await(0,r.mZ)((0,r.H9)(s,"users","".concat(t)),{coins:a,updateAtTrans:"COIN_".concat(new Date),transactionId:"".concat(n)})}catch(o){console.error("Error updateCoinsUser: ",o)}},d=async e=>{let{id:t,coins:a,language:n,numAds:o,expDateAds:i}=e;try{let e={};n&&(e={...e,language:n}),null!==a&&void 0!==a&&(e={...e,coins:a}),null!==o&&void 0!==o&&(e={...e,numAds:o}),null!==i&&void 0!==i&&(e={...e,expDateAds:i}),await(0,r.mZ)((0,r.H9)(s,"users","".concat(t)),{...e,updateAt:new Date})}catch(c){console.error("Error updateCoinsUser: ",c)}},p=async e=>{try{let t;const a=(0,r.H9)(s,"users","".concat(e)),n=await(0,r.x7)(a);return n.exists()&&(t=n.data()),t}catch(t){console.error("Error getUser: ",t)}},u=async e=>{let{model:t,server:a,text:r,cursor:n}=e;try{"".concat(window.location.protocol,"//").concat(a);const e=new Headers;e.append("Content-Type","application/json"),e.append("Accept","application/json, text/plain, */*"),e.append("Accept-Language","en-US,en;q=0.9"),e.append("Referer","https://lexica.art/");return o.Ze}catch(s){return console.log("Kai Error ",s),{error:!0}}}},1940:(e,t,a)=>{a.d(t,{M:()=>n,n:()=>s});var r=a(4451);const n=(0,r.j)((()=>a.e(465).then(a.bind(a,465))),(e=>e.ImageFast)),s=(0,r.j)((()=>a.e(919).then(a.bind(a,8919))),(e=>e.ImageSkeleton))},4137:(e,t,a)=>{a.r(t),a.d(t,{AlbumPage:()=>b});var r=a(9950),n=a(6455),s=a(3247),o=a(1389),i=a(4418),c=a(5890),l=a(5439),d=a(1374),p=a(1317),u=a(194),m=a(8671),h=a(1878),x=a(5236),g=a(712),w=a(7385),f=a(327),y=a(6256),v=a(1940),j=a(4414);let S=window.innerWidth>500?500:window.innerWidth;window.innerHeight;const b=()=>{const{configs:e,user:t}=(0,r.useContext)(x.rf),{setConfigs:a,setUser:b}=(0,r.useContext)(x.D8),[A,C]=(0,r.useState)(!0),[H,_]=(0,r.useState)(!1),[k,I]=(0,r.useState)(!0),[E,F]=(0,r.useState)(0),[L,D]=(0,r.useState)([]),[U,z]=(0,r.useState)("All"),W=async t=>{let{isFirst:a,_textKey:r,_cursor:n}=t;if(!H&&n<=e.limitSearch){_(!0);let t=await(0,g.FH)({server:e&&e.lexicaSearch?e.lexicaSearch:"https://lexica.art/api/infinite-prompts",model:e&&e.modelLexica?e.modelLexica:"lexica-aperture-v2",text:r,cursor:n});if(t&&t.prompts&&0===t.prompts.length&&(t=await(0,g.FH)({server:e&&e.lexicaSearch?e.lexicaSearch:"https://lexica.art/api/infinite-prompts",model:e&&e.modelLexica?e.modelLexica:"lexica-aperture-v2",text:r,cursor:n})),t&&t.prompts&&0===t.prompts.length&&(t=await(0,g.FH)({server:e&&e.lexicaSearch?e.lexicaSearch:"https://lexica.art/api/infinite-prompts",model:e&&e.modelLexica?e.modelLexica:"lexica-aperture-v2",text:r,cursor:n})),t&&t.prompts&&0===t.prompts.length&&(t=await(0,g.FH)({server:e&&e.lexicaSearch?e.lexicaSearch:"https://lexica.art/api/infinite-prompts",model:e&&e.modelLexica?e.modelLexica:"lexica-aperture-v2",text:r,cursor:n})),t&&t.prompts&&t.prompts.length){const{prompts:a}=t,r=[];for(let t=0;t<a.length;t++){const n=a[t];r.push({id:n.id,textKey:n.prompt,negativeKey:n.negativePrompt?n.negativePrompt:"",uri:n.images.length?"".concat(e.lexicaImageSm2,"/").concat(n.images[0].id):"",width:n.width,height:n.height,isLast:t===a.length-1?L.length+a.length:0})}D([...L,...r]),F(n+50),n+50===e.limitSearch&&I(!1)}else D([]);!A&&await(0,w.y)(1e3),_(!1)}};(0,r.useEffect)((()=>{(async()=>{if(!e){const e=await(0,g.Y_)();a(e)}await W({isFirst:!1,_textKey:"",_cursor:0}),window.scrollTo(0,0)})(),(async()=>{var e;const a=null===(e=window.Telegram)||void 0===e?void 0:e.WebApp;if(a&&!t){a.ready();const e=a.initDataUnsafe.user;if(e){let t={id:e.id,username:"".concat(e.last_name," ").concat(e.first_name),coins:0};const a=await(0,g.wz)(t.id);a?t={...a,username:"".concat(e.last_name," ").concat(e.first_name)}:await(0,g.kg)(t),b(t)}}})()}),[]);const K=(0,r.useCallback)((async()=>{const{scrollTop:e,scrollHeight:t,clientHeight:a}=document.documentElement;e+a>=t-.5&&await W({isFirst:!1,_textKey:"",_cursor:0})}),[L]);return(0,r.useEffect)((()=>(window.addEventListener("scroll",K),()=>window.removeEventListener("scroll",K))),[K]),(0,j.jsxs)(s.az,{children:[(0,j.jsxs)(n.mg,{children:[(0,j.jsx)("title",{children:"Album"}),(0,j.jsx)("meta",{name:"description",content:"Midjourney AI"})]}),(0,j.jsxs)(o.B,{h:"100vh",w:S,py:16,px:2,spacing:4,children:[(0,j.jsx)(o.B,{children:(0,j.jsx)(i.z,{pos:"fixed",zIndex:999,right:2,children:(0,j.jsxs)(c.W,{children:[(0,j.jsx)(l.I,{variant:"outline",borderRadius:"full",borderColor:"purple.400",borderWidth:1,as:d.$,rightIcon:(0,j.jsx)(f.gpS,{color:"white",size:18}),size:"sm",minW:20,_focus:{bg:"transparent"},_hover:{bg:"transparent"},_expanded:{bg:"transparent"},children:(0,j.jsx)(p.E,{color:"white",fontSize:14,fontWeight:"700",children:U})}),(0,j.jsx)(u.c,{backgroundColor:"gray.800",borderColor:"gray.800",color:"white",children:(0,j.jsxs)(m.i,{defaultValue:"All",type:"radio",onChange:e=>{z(e)},children:[(0,j.jsx)(h.k,{backgroundColor:"transparent",value:"All",children:"All"}),(0,j.jsx)(h.k,{backgroundColor:"transparent",value:"Photos",children:"Photos"}),(0,j.jsx)(h.k,{backgroundColor:"transparent",value:"Videos",children:"Videos"})]})})]})})}),(0,j.jsx)(o.B,{padding:0,pb:40,pt:6,onScroll:K,children:(0,j.jsx)(y.A,{columnsCount:2,gutter:"16px",children:L.map(((e,t)=>{const{id:a,uri:r}=e;return(0,j.jsx)(v.M,{uri:r},t)}))})})]})]})}},7385:(e,t,a)=>{a.d(t,{S:()=>n,y:()=>r});const r=e=>new Promise((t=>setTimeout(t,e))),n=e=>new Promise(((t,a)=>{const r=new FileReader;r.onloadend=()=>t(r.result),r.readAsDataURL(e)}))}}]);