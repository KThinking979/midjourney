"use strict";(self.webpackChunkmidjourney=self.webpackChunkmidjourney||[]).push([[176],{1940:(e,t,s)=>{s.d(t,{Kc:()=>o,MF:()=>i,ay:()=>n,nn:()=>r});var a=s(4451);const i=(0,a.j)((()=>s.e(465).then(s.bind(s,465))),(e=>e.ImageFast)),r=(0,a.j)((()=>s.e(9606).then(s.bind(s,9606))),(e=>e.ImageSkeleton)),o=(0,a.j)((()=>s.e(2613).then(s.bind(s,2613))),(e=>e.ImageSkeletonShow)),n=(0,a.j)((()=>s.e(8977).then(s.bind(s,8977))),(e=>e.ImageSkeletonFace))},176:(e,t,s)=>{s.r(t),s.d(t,{ModalGenArt:()=>W});var a=s(9950),i=s(2099),r=s(4521),o=s(2463),n=s(2505),c=s(4787),h=s(3247),l=s(4418),d=s(393),w=s(1317),y=s(6569),p=s(1389),u=s(2481),g=s(1374),v=s(5236),x=s(3246),m=s(1940),S=s(5495),f=s(712),k=s(4456),j=s(9591),K=s(7385),b=s(3124),I=s(7956),_=s(2096),N=s(6742),C=s(6451),A=s(4414);let F=window.innerWidth>500?500:window.innerWidth,T=!1;const W=e=>{let{isOpen:t,onClose:W,dataAI:D}=e;const P=(0,i.d)(),{t:E,i18n:L}=(0,N.B)(),{user:H,configs:z}=(0,a.useContext)(v.rf),{setUser:B}=(0,a.useContext)(v.D8),[R,V]=(0,a.useState)(!1),[G,U]=(0,a.useState)(!1),[O,Q]=(0,a.useState)(!1),[J,Y]=(0,a.useState)(!1),[$,M]=(0,a.useState)(),[Z,q]=(0,a.useState)(""),[X,ee]=(0,a.useState)(""),[te,se]=(0,a.useState)(""),[ae,ie]=(0,a.useState)(""),[re,oe]=(0,a.useState)("");(0,a.useEffect)((()=>{window.scrollTo(0,0),H&&D&&t&&ne({isFree:D.isFree})}),[D,t]);const ne=async e=>{let t,{isFree:s}=e;T=!1;let a=0;try{if(H&&D){const e=H;V(!0),U(!1),M(D),q(""),ee(""),se(""),ie(""),oe("");let i=D.prompt,r=D.negative;if(z.isTranslate&&"en"!==H.language){const e=await(0,f.sS)({text:D.prompt,targetLanguage:"en",apiKey:z.apiKeyTranslate}),t=await(0,f.sS)({text:D.negative,targetLanguage:"en",apiKey:z.apiKeyTranslate});i=e.data,r=t.data}const o=D.style?D.style.key:"";let n="".concat(o.replace("{prompt}",i));const c=D.style?D.style.negativeKey:"";let h="".concat(r," ").concat(c);if(s||!s&&parseFloat(e.coins)>=parseFloat(D.feeCoin)){let e=null;D.isText||D.type!==k.Wk.GEN||"ProGen"!==D.model||(e=await(0,f.jH)({data:D.base64,folder:"input",name:(0,I.A)(),isUrl:!!Z.includes("http")}),D.image.url=e);for(let s=0;s<D.samples&&!T;s++){let i=D.seed;if(-1===D.seed&&(i=(0,K.RZ)({min:0,max:k.Vm})),D.type===k.Wk.GEN_SD3){const e={...D,stylePreset:D.style.stylePreset,aspectRatio:D.aspectRatio.title,seed:i,textKey:n,negativeKey:h,token:z.token,server:z.serverSD3};t=await(0,f.DS)(e),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.DS)(e)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.DS)(e)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.DS)(e)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=D.isText?await(0,f.Ip)({...D,seed:i,steps:20*D.steps/30,width:D.width,height:D.height,model:"dreamshaper_8_93211.safetensors",textKey:n,negativeKey:h,isHD:!1,token:z.tokenNov,server:z.serverNov}):await(0,f.Ip)({...D,base64:"",seed:i,steps:20*D.steps/30,width:D.width,height:D.height,model:"dreamshaper_8_93211.safetensors",textKey:n,negativeKey:h,isHD:!1,token:z.tokenNov,server:z.serverNov})),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),D.isText,t=await(0,f.Ip)({...D,seed:i,steps:20*D.steps/30,width:D.width,height:D.height,model:"dreamshaper_8_93211.safetensors",textKey:n,negativeKey:h,isHD:!0,token:z.tokenNov,server:z.serverNov}))}if(D.type===k.Wk.GEN_CORE){const e={...D,stylePreset:D.style.stylePreset,aspectRatio:D.aspectRatio.title,seed:i,textKey:n,negativeKey:h,token:z.token,server:z.serverSD3};t=await(0,f.Kh)(e),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.Kh)(e)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.Kh)(e)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.Kh)(e)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=D.isText?await(0,f.Ip)({...D,seed:i,steps:20*D.steps/30,width:D.width,height:D.height,model:"dreamshaper_8_93211.safetensors",textKey:n,negativeKey:h,isHD:!1,token:z.tokenNov,server:z.serverNov}):await(0,f.Ip)({...D,base64:"",seed:i,steps:20*D.steps/30,width:D.width,height:D.height,model:"dreamshaper_8_93211.safetensors",textKey:n,negativeKey:h,isHD:!1,token:z.tokenNov,server:z.serverNov})),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),D.isText,t=await(0,f.Ip)({...D,seed:i,steps:20*D.steps/30,width:D.width,height:D.height,model:"dreamshaper_8_93211.safetensors",textKey:n,negativeKey:h,isHD:!0,token:z.tokenNov,server:z.serverNov}))}if(D.type===k.Wk.GEN_ULTRA){const e={...D,stylePreset:D.style.stylePreset,aspectRatio:D.aspectRatio.title,seed:i,textKey:n,negativeKey:h,token:z.token,server:z.serverSD3};t=await(0,f.jV)(e),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.jV)(e)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.jV)(e)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.jV)(e)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=D.isText?await(0,f.Ip)({...D,seed:i,steps:20*D.steps/30,width:D.width,height:D.height,model:"dreamshaper_8_93211.safetensors",textKey:n,negativeKey:h,isHD:!1,token:z.tokenNov,server:z.serverNov}):await(0,f.Ip)({...D,base64:"",seed:i,steps:20*D.steps/30,width:D.width,height:D.height,model:"dreamshaper_8_93211.safetensors",textKey:n,negativeKey:h,isHD:!1,token:z.tokenNov,server:z.serverNov})),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),D.isText,t=await(0,f.Ip)({...D,seed:i,steps:20*D.steps/30,width:D.width,height:D.height,model:"dreamshaper_8_93211.safetensors",textKey:n,negativeKey:h,isHD:!0,token:z.tokenNov,server:z.serverNov}))}if(D.type===k.Wk.GEN&&"ProGen"===D.model){const s={...D,stylePreset:D.style.stylePreset,seed:i,textKey:n,negativeKey:h,token:z.tokenFAL,server:z.serverFAL};t=D.isText?await(0,f.QN)(s):await(0,f.oY)(s),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=D.isText?await(0,f.QN)(s):await(0,f.oY)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=D.isText?await(0,f.QN)(s):await(0,f.oY)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=D.isText?await(0,f.QN)(s):await(0,f.oY)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=D.isText?await(0,f.Ip)({...D,seed:i,steps:20*D.steps/30,width:D.width,height:D.height,model:"dreamshaper_8_93211.safetensors",textKey:n,negativeKey:h,isHD:!0,token:z.tokenNov,server:z.serverNov}):await(0,f.Ip)({...D,base64:"",seed:i,steps:20*D.steps/30,width:D.width,height:D.height,model:"dreamshaper_8_93211.safetensors",textKey:n,negativeKey:h,isHD:!0,token:z.tokenNov,server:z.serverNov})),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),D.isText,t=await(0,f.Ip)({...D,seed:i,steps:20*D.steps/30,width:D.width,height:D.height,model:"dreamshaper_8_93211.safetensors",textKey:n,negativeKey:h,isHD:!1,token:z.tokenNov,server:z.serverNov})),e&&(0,f.Ww)({url:e})}if(D.type===k.Wk.GEN&&"ProGen"!==D.model){const e={...D,seed:i,steps:20*D.steps/30,width:D.width,height:D.height,textKey:n,negativeKey:h,token:z.tokenNov,server:z.serverNov};t=D.isText?await(0,f.Ip)(e):await(0,f.EQ)(e),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=D.isText?await(0,f.Ip)(e):await(0,f.EQ)(e)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=D.isText?await(0,f.Ip)(e):await(0,f.EQ)(e)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=D.isText?await(0,f.Ip)(e):await(0,f.EQ)(e))}if(D.type===k.Wk.ILLUSION){const e={...D,seed:i,steps:20*D.steps/30,width:D.width,height:D.height,textKey:n,negativeKey:h,token:z.tokenNov,server:z.isIllusionV3?z.serverNov3:z.serverNov};t=z.isIllusionV3?await(0,f.aB)(e):await(0,f.v7)(e),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=z.isIllusionV3?await(0,f.aB)(e):await(0,f.v7)(e)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=z.isIllusionV3?await(0,f.aB)(e):await(0,f.v7)(e)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=z.isIllusionV3?await(0,f.aB)(e):await(0,f.v7)(e))}if(D.type===k.Wk.FACE_SWAP){let e;const s=await(0,f.jH)({data:D.base64,folder:"input",name:(0,I.A)(),isUrl:!!Z.includes("http")});D.image.url=s,"Custom"===D.style.title&&(e=await(0,f.jH)({data:D.style.base64,folder:"input",name:(0,I.A)(),isUrl:!!Z.includes("http")}),D.style.url=e);const a={...D,swapImage:{...D.image},baseImage:{url:D.style.url},token:z.tokenFAL,server:z.serverFAL};t=await(0,f.W_)(a),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.W_)(a)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.W_)(a)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.W_)(a)),s&&(0,f.Ww)({url:s}),e&&(0,f.Ww)({url:e})}if(D.type===k.Wk.FACE_STICKER){const e=(0,I.A)(),s=await(0,f.jH)({data:D.base64,folder:"input",name:e,isUrl:!!Z.includes("http")});D.image.url=s;const a={...D,token:z.tokenFAL,server:z.serverFAL};t=await(0,f.eL)(a),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.eL)(a)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.eL)(a)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.eL)(a)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.eL)(a)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.eL)(a)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.eL)(a)),(0,f.Ww)({url:s})}if(D.type===k.Wk.UPSCALE){const e=(0,I.A)();let s=await(0,f.ZJ)({file:D.image,width:540,height:540});const a=await(0,K.Sk)(s);D.base64=a;const r=await(0,f.jH)({data:D.base64,folder:"input",name:e,isUrl:!!Z.includes("http")});D.image.url=r;const o={...D,seed:i,textKey:D.prompt,negativeKey:D.negative,token:z.tokenFAL,server:z.serverFAL};"Esrgan"===D.style.name&&(t=await(0,f.J3)(o),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.J3)(o)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.J3)(o)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.J3)(o))),"Ccsr"===D.style.name&&(t=await(0,f.ym)(o),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.ym)(o)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.ym)(o)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.ym)(o))),"Clarity"===D.style.name&&(t=await(0,f.rj)(o),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.rj)(o)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.rj)(o)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.rj)(o))),console.log("res ",t)}if(t&&!t.error){if(0===s&&q(t.data),4===D.samples)switch(s){case 0:ee(t.data);break;case 1:se(t.data);break;case 2:ie(t.data);break;case 3:oe(t.data)}t.isSuccess&&(a+=parseFloat(D.feeCoin)/D.samples)}}}if(V(!1),s){const e=(new Date).toUTCString(),t="".concat(H.dateAds,"_").concat(D.mode,"_ADS_V1_").concat(e);(0,f.TK)({id:H.id,updatedAt:t})}else{const t=parseFloat(e.coins)-a,s=(new Date).toUTCString(),i="".concat(e.coins,"-").concat(a,"=").concat(t,"_Gen_V1_IOS_").concat(s);null===t&&void 0===t||(await(0,f.TK)({id:H.id,coins:t<0?0:t,updatedAt:i}),B({...H,coins:t<0?0:t}))}U(!0)}else W&&W()}catch(i){console.log("Error ",i),V(!1)}},ce=(0,a.useCallback)((async()=>{H&&(parseFloat(H.coins)>=parseFloat($.feeCoin)?ne({isFree:!1}):parseFloat($.feeCoin)>5?W&&W():Q(!0))}),[H,$]),he=(0,a.useCallback)((async()=>{if(H)try{V(!0);const e=(0,I.A)(),t=await(0,f.jH)({data:Z,folder:"albums",name:e,isUrl:!!Z.includes("http")}),s={id:e,userId:H.id,type:$.type,isImage:!0,prompt:$.prompt,negative:$.negative,style:$.type.includes("GEN")?$.style.title:"None",width:$.width,height:$.height,steps:$.steps,scale:$.scale,uri:t};await(0,f.Y4)({id:e,data:s}),P({title:E(C.P.dashboard.saved),status:"success",position:"bottom",isClosable:!0,duration:2e3}),V(!1)}catch(e){V(!1)}}),[$,Z]),le=F;return(0,A.jsxs)(r.aF,{onClose:W,isOpen:t,size:"full",children:[(0,A.jsx)(o.m,{backgroundColor:"black"}),(0,A.jsx)(n.$,{backgroundColor:"black",zIndex:9999,children:(0,A.jsxs)(c.c,{p:0,backgroundColor:"black",children:[(0,A.jsx)(h.az,{transition:"0.9s ease",pos:"fixed",top:0,w:"full",zIndex:999,children:(0,A.jsxs)(l.z,{flex:1,p:2,justifyContent:"space-between",w:"full",minH:"40px",children:[(0,A.jsx)(d.I,{as:"ltr"===L.dir()?_.m6W:_.OQo,boxSize:7,padding:0,color:"white",zIndex:999,onClick:()=>{W&&W()}}),(0,A.jsxs)(l.z,{alignItems:"center",justifyContent:"center",children:[(0,A.jsx)(w.E,{fontSize:"18px",fontWeight:500,lineHeight:"17px",letterSpacing:"0.5px",color:"white",textAlign:"center",children:H&&H.coins?(new Intl.NumberFormat).format(H.coins):0}),(0,A.jsx)(y._,{borderRadius:"full",boxSize:"20px",src:s(2975),alt:"coin"})]})]})}),(0,A.jsxs)(p.B,{h:"100vh",w:F,pt:20,px:2,justifyContent:"space-between",children:[(0,A.jsxs)(p.B,{flex:1,children:[$&&1===$.samples&&(0,A.jsx)(p.B,{flex:1,justifyContent:"center",children:(0,A.jsx)(m.Kc,{uri:Z,width:F,height:F/($.width/$.height)},Z)}),$&&4===$.samples&&!G&&(0,A.jsx)(p.B,{flex:1,justifyContent:"center",children:(0,A.jsxs)(u.x,{templateColumns:"repeat(2, 1fr)",gap:6,children:[(0,A.jsx)(m.Kc,{uri:X,width:le/2,height:le/($.width/$.height)/2},1),(0,A.jsx)(m.Kc,{uri:te,width:le/2,height:le/($.width/$.height)/2},2),(0,A.jsx)(m.Kc,{uri:ae,width:le/2,height:le/($.width/$.height)/2},3),(0,A.jsx)(m.Kc,{uri:re,width:le/2,height:le/($.width/$.height)/2},4)]})}),$&&4===$.samples&&G&&(0,A.jsx)(p.B,{flex:1,justifyContent:"center",children:(0,A.jsxs)(l.z,{spacing:1,children:[(0,A.jsx)(p.B,{w:"10%",children:(0,A.jsxs)(u.x,{templateColumns:"repeat(1, 1fr)",gap:6,children:[(0,A.jsx)(m.Kc,{isActive:Z===X,uri:X,width:.2*le/2,height:.2*le/($.width/$.height)/2,onPress:()=>{q(X)}},1),(0,A.jsx)(m.Kc,{isActive:Z===te,uri:te,width:.2*le/2,height:.2*le/($.width/$.height)/2,onPress:()=>{q(te)}},2),(0,A.jsx)(m.Kc,{isActive:Z===ae,uri:ae,width:.2*le/2,height:.2*le/($.width/$.height)/2,onPress:()=>{q(ae)}},3),(0,A.jsx)(m.Kc,{isActive:Z===re,uri:re,width:.2*le/2,height:.2*le/($.width/$.height)/2,onPress:()=>{q(re)}},4)]})}),(0,A.jsx)(p.B,{w:"90%",children:(0,A.jsx)(m.Kc,{uri:Z,width:.8*le,height:.8*le/($.width/$.height)},Z)})]})})]}),(0,A.jsx)(p.B,{pb:2,spacing:4,justifyContent:"center",w:"full",backgroundColor:"black",maxW:"500px",children:(0,A.jsxs)(l.z,{spacing:2,children:[(0,A.jsx)(g.$,{py:4,my:4,colorScheme:"purple",borderRadius:"full",onClick:ce,leftIcon:(0,A.jsx)(d.I,{as:j.aO_}),flex:1,children:(0,A.jsx)(l.z,{children:(0,A.jsx)(w.E,{color:"white",fontSize:16,fontWeight:"700",children:E(C.P.dashboard.re_create)})})}),(0,A.jsx)(g.$,{flex:1,py:4,mx:2,my:4,colorScheme:"blue",borderRadius:"full",onClick:he,leftIcon:(0,A.jsx)(d.I,{as:S.gWm}),children:(0,A.jsx)(l.z,{children:(0,A.jsx)(w.E,{color:"white",fontSize:16,fontWeight:"700",children:E(C.P.dashboard.save)})})})]})})]}),(0,A.jsx)(b.s,{isOpen:O,onClose:()=>Q(!O),onPressPay:()=>{Q(!1),Y(!0)},onPressAds:()=>{Q(!1),ne({isFree:!0})}}),(0,A.jsx)(x.QV,{isOpen:J,onClose:()=>{Y(!1)}}),(0,A.jsx)(x.aj,{isOpen:R})]})})]})}}}]);