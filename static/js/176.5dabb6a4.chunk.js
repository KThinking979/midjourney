"use strict";(self.webpackChunkmidjourney=self.webpackChunkmidjourney||[]).push([[176],{91940:(e,t,s)=>{s.d(t,{Kc:()=>o,MF:()=>a,ay:()=>n,nn:()=>r});var i=s(24451);const a=(0,i.j)((()=>s.e(465).then(s.bind(s,90465))),(e=>e.ImageFast)),r=(0,i.j)((()=>s.e(9606).then(s.bind(s,19606))),(e=>e.ImageSkeleton)),o=(0,i.j)((()=>s.e(2613).then(s.bind(s,92613))),(e=>e.ImageSkeletonShow)),n=(0,i.j)((()=>s.e(8977).then(s.bind(s,88977))),(e=>e.ImageSkeletonFace))},90176:(e,t,s)=>{s.r(t),s.d(t,{ModalGenArt:()=>D});var i=s(9950),a=s(22099),r=s(64521),o=s(22463),n=s(42505),c=s(44787),h=s(63247),l=s(34418),w=s(20393),d=s(31317),y=s(46569),p=s(81389),u=s(92481),g=s(81374),v=s(45236),x=s(33246),m=s(91940),S=s(25495),f=s(70712),k=s(44456),j=s(69591),K=s(67385),b=s(43124),I=s(67956),_=s(82096),C=s(36742),N=s(26451),F=s(44414);let A=window.innerWidth>500?500:window.innerWidth,W=!1;const D=e=>{let{isOpen:t,onClose:D,dataAI:T}=e;const P=(0,a.d)(),{t:E}=(0,C.B)(),{user:H,configs:L}=(0,i.useContext)(v.rf),{setUser:z}=(0,i.useContext)(v.D8),[B,O]=(0,i.useState)(!1),[R,V]=(0,i.useState)(!1),[U,G]=(0,i.useState)(!1),[J,Q]=(0,i.useState)(!1),[$,M]=(0,i.useState)(),[Z,Y]=(0,i.useState)(""),[q,X]=(0,i.useState)(""),[ee,te]=(0,i.useState)(""),[se,ie]=(0,i.useState)(""),[ae,re]=(0,i.useState)("");(0,i.useEffect)((()=>{window.scrollTo(0,0),H&&T&&t&&oe({isFree:T.isFree})}),[T,t]);const oe=async e=>{let t,{isFree:s}=e;W=!1;let i=0;try{if(H&&T){const e=H;O(!0),V(!1),M(T),Y(""),X(""),te(""),ie(""),re("");const a=T.style?T.style.key:"";let r="".concat(a.replace("{prompt}",T.prompt));const o=T.style?T.style.negativeKey:"",n="".concat(T.negativeKey," ").concat(o);if(s||!s&&parseFloat(e.coins)>=parseFloat(T.feeCoin))for(let s=0;s<T.samples&&!W;s++){let e=T.seed;if(-1===T.seed&&(e=(0,K.RZ)({min:0,max:k.Vm})),T.type===k.Wk.GEN_SD3){const s={...T,stylePreset:T.style.stylePreset,aspectRatio:T.aspectRatio.title,seed:e,textKey:r,negativeKey:n,token:L.token,server:L.serverSD3};t=await(0,f.DS)(s),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.DS)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.DS)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.DS)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=T.isText?await(0,f.Ip)({...T,seed:e,steps:20*T.steps/30,width:T.width,height:T.height,model:"dreamshaper_8_93211.safetensors",textKey:r,negativeKey:n,isHD:!1,token:L.tokenNov,server:L.serverNov}):await(0,f.Ip)({...T,base64:"",seed:e,steps:20*T.steps/30,width:T.width,height:T.height,model:"dreamshaper_8_93211.safetensors",textKey:r,negativeKey:n,isHD:!1,token:L.tokenNov,server:L.serverNov})),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),T.isText,t=await(0,f.Ip)({...T,seed:e,steps:20*T.steps/30,width:T.width,height:T.height,model:"dreamshaper_8_93211.safetensors",textKey:r,negativeKey:n,isHD:!0,token:L.tokenNov,server:L.serverNov}))}if(T.type===k.Wk.GEN_CORE){const s={...T,stylePreset:T.style.stylePreset,aspectRatio:T.aspectRatio.title,seed:e,textKey:r,negativeKey:n,token:L.token,server:L.serverSD3};t=await(0,f.Kh)(s),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.Kh)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.Kh)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.Kh)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=T.isText?await(0,f.Ip)({...T,seed:e,steps:20*T.steps/30,width:T.width,height:T.height,model:"dreamshaper_8_93211.safetensors",textKey:r,negativeKey:n,isHD:!1,token:L.tokenNov,server:L.serverNov}):await(0,f.Ip)({...T,base64:"",seed:e,steps:20*T.steps/30,width:T.width,height:T.height,model:"dreamshaper_8_93211.safetensors",textKey:r,negativeKey:n,isHD:!1,token:L.tokenNov,server:L.serverNov})),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),T.isText,t=await(0,f.Ip)({...T,seed:e,steps:20*T.steps/30,width:T.width,height:T.height,model:"dreamshaper_8_93211.safetensors",textKey:r,negativeKey:n,isHD:!0,token:L.tokenNov,server:L.serverNov}))}if(T.type===k.Wk.GEN_ULTRA){const s={...T,stylePreset:T.style.stylePreset,aspectRatio:T.aspectRatio.title,seed:e,textKey:r,negativeKey:n,token:L.token,server:L.serverSD3};t=await(0,f.jV)(s),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.jV)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.jV)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.jV)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=T.isText?await(0,f.Ip)({...T,seed:e,steps:20*T.steps/30,width:T.width,height:T.height,model:"dreamshaper_8_93211.safetensors",textKey:r,negativeKey:n,isHD:!1,token:L.tokenNov,server:L.serverNov}):await(0,f.Ip)({...T,base64:"",seed:e,steps:20*T.steps/30,width:T.width,height:T.height,model:"dreamshaper_8_93211.safetensors",textKey:r,negativeKey:n,isHD:!1,token:L.tokenNov,server:L.serverNov})),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),T.isText,t=await(0,f.Ip)({...T,seed:e,steps:20*T.steps/30,width:T.width,height:T.height,model:"dreamshaper_8_93211.safetensors",textKey:r,negativeKey:n,isHD:!0,token:L.tokenNov,server:L.serverNov}))}if(T.type===k.Wk.GEN&&"ProGen"===T.model){const s={...T,stylePreset:T.style.stylePreset,seed:e,textKey:r,negativeKey:n,token:L.token,server:L.server};t=T.isText?await(0,f.F)(s):await(0,f.fO)(s),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=T.isText?await(0,f.F)(s):await(0,f.fO)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=T.isText?await(0,f.F)(s):await(0,f.fO)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=T.isText?await(0,f.F)(s):await(0,f.fO)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=T.isText?await(0,f.Ip)({...T,seed:e,steps:20*T.steps/30,width:T.width,height:T.height,model:"dreamshaper_8_93211.safetensors",textKey:r,negativeKey:n,isHD:!0,token:L.tokenNov,server:L.serverNov}):await(0,f.Ip)({...T,base64:"",seed:e,steps:20*T.steps/30,width:T.width,height:T.height,model:"dreamshaper_8_93211.safetensors",textKey:r,negativeKey:n,isHD:!0,token:L.tokenNov,server:L.serverNov})),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),T.isText,t=await(0,f.Ip)({...T,seed:e,steps:20*T.steps/30,width:T.width,height:T.height,model:"dreamshaper_8_93211.safetensors",textKey:r,negativeKey:n,isHD:!1,token:L.tokenNov,server:L.serverNov}))}if(T.type===k.Wk.GEN&&"ProGen"!==T.model){const s={...T,seed:e,steps:20*T.steps/30,width:T.width,height:T.height,textKey:r,negativeKey:n,token:L.tokenNov,server:L.serverNov};t=T.isText?await(0,f.Ip)(s):await(0,f.EQ)(s),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=T.isText?await(0,f.Ip)(s):await(0,f.EQ)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=T.isText?await(0,f.Ip)(s):await(0,f.EQ)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=T.isText?await(0,f.Ip)(s):await(0,f.EQ)(s))}if(T.type===k.Wk.ILLUSION){const s={...T,seed:e,steps:20*T.steps/30,width:T.width,height:T.height,textKey:r,negativeKey:n,token:L.tokenNov,server:L.isIllusionV3?L.serverNov3:L.serverNov};t=L.isIllusionV3?await(0,f.aB)(s):await(0,f.v7)(s),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=L.isIllusionV3?await(0,f.aB)(s):await(0,f.v7)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=L.isIllusionV3?await(0,f.aB)(s):await(0,f.v7)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=L.isIllusionV3?await(0,f.aB)(s):await(0,f.v7)(s))}if(T.type===k.Wk.FACE_SWAP){let e;const s=await(0,f.jH)({data:T.base64,folder:"input",name:(0,I.A)(),isUrl:!!Z.includes("http")});T.image.url=s,"Custom"===T.style.title&&(e=await(0,f.jH)({data:T.style.base64,folder:"input",name:(0,I.A)(),isUrl:!!Z.includes("http")}),T.style.url=e);const i={...T,swapImage:{...T.image},baseImage:{url:T.style.url},token:L.tokenFAL,server:L.serverFAL};t=await(0,f.W_)(i),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.W_)(i)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.W_)(i)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.W_)(i)),s&&(0,f.Ww)({url:s}),e&&(0,f.Ww)({url:e})}if(T.type===k.Wk.FACE_STICKER){const e=(0,I.A)(),s=await(0,f.jH)({data:T.base64,folder:"input",name:e,isUrl:!!Z.includes("http")});T.image.url=s;const i={...T,token:L.tokenFAL,server:L.serverFAL};t=await(0,f.eL)(i),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.eL)(i)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.eL)(i)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.eL)(i)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.eL)(i)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.eL)(i)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.eL)(i)),(0,f.Ww)({url:s})}if(T.type===k.Wk.UPSCALE){const s=(0,I.A)();let i=await(0,f.ZJ)({file:T.image,width:540,height:540});const a=await(0,K.Sk)(i);T.base64=a;const r=await(0,f.jH)({data:T.base64,folder:"input",name:s,isUrl:!!Z.includes("http")});T.image.url=r;const o={...T,seed:e,textKey:T.prompt,negativeKey:T.negative,token:L.tokenFAL,server:L.serverFAL};"Esrgan"===T.style.name&&(t=await(0,f.J3)(o),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.J3)(o)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.J3)(o)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.J3)(o))),"Ccsr"===T.style.name&&(t=await(0,f.ym)(o),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.ym)(o)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.ym)(o)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.ym)(o))),"Clarity"===T.style.name&&(t=await(0,f.rj)(o),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.rj)(o)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.rj)(o)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.rj)(o))),(0,f.Ww)({url:r})}if(t&&!t.error){if(0===s&&Y(t.data),4===T.samples)switch(s){case 0:X(t.data);break;case 1:te(t.data);break;case 2:ie(t.data);break;case 3:re(t.data)}t.isSuccess&&(i+=parseFloat(T.feeCoin)/T.samples)}}if(O(!1),s){const e=(new Date).toUTCString(),t="".concat(H.dateAds,"_").concat(T.mode,"_ADS_V1_").concat(e);(0,f.TK)({id:H.id,updatedAt:t})}else{const t=parseFloat(e.coins)-i,s=(new Date).toUTCString(),a="".concat(e.coins,"-").concat(i,"=").concat(t,"_Gen_V1_IOS_").concat(s);null===t&&void 0===t||(await(0,f.TK)({id:H.id,coins:t<0?0:t,updatedAt:a}),z({...H,coins:t<0?0:t}))}V(!0)}else D&&D()}catch(a){console.log("Error ",a),O(!1)}},ne=(0,i.useCallback)((async()=>{H&&(parseFloat(H.coins)>=parseFloat($.feeCoin)?oe({isFree:!1}):parseFloat($.feeCoin)>5?D&&D():G(!0))}),[H,$]),ce=(0,i.useCallback)((async()=>{if(H)try{O(!0);const e=(0,I.A)(),t=await(0,f.jH)({data:Z,folder:"albums",name:e,isUrl:!!Z.includes("http")}),s={id:e,userId:H.id,type:$.type,isImage:!0,prompt:$.prompt,negative:$.negative,style:$.type.includes("GEN")?$.style.title:"None",width:$.width,height:$.height,steps:$.steps,scale:$.scale,uri:t};await(0,f.Y4)({id:e,data:s}),P({title:E(N.P.dashboard.saved),status:"success",position:"bottom",isClosable:!0,duration:2e3}),O(!1)}catch(e){O(!1)}}),[$,Z]),he=A;return(0,F.jsxs)(r.aF,{onClose:D,isOpen:t,size:"full",children:[(0,F.jsx)(o.m,{backgroundColor:"black"}),(0,F.jsx)(n.$,{backgroundColor:"black",zIndex:9999,children:(0,F.jsxs)(c.c,{p:0,backgroundColor:"black",children:[(0,F.jsx)(h.az,{transition:"0.9s ease",pos:"fixed",top:0,w:"full",zIndex:999,children:(0,F.jsxs)(l.z,{flex:1,p:2,justifyContent:"space-between",w:"full",minH:"40px",children:[(0,F.jsx)(w.I,{as:_.m6W,boxSize:7,padding:0,color:"white",zIndex:999,onClick:()=>{D&&D()}}),(0,F.jsxs)(l.z,{alignItems:"center",justifyContent:"center",children:[(0,F.jsx)(d.E,{fontSize:"18px",fontWeight:500,lineHeight:"17px",letterSpacing:"0.5px",color:"white",textAlign:"center",children:H&&H.coins?(new Intl.NumberFormat).format(H.coins):0}),(0,F.jsx)(y._,{borderRadius:"full",boxSize:"20px",src:s(42975),alt:"coin"})]})]})}),(0,F.jsxs)(p.B,{h:"100vh",w:A,pt:20,px:2,justifyContent:"space-between",children:[(0,F.jsxs)(p.B,{flex:1,children:[$&&1===$.samples&&(0,F.jsx)(p.B,{flex:1,justifyContent:"center",children:(0,F.jsx)(m.Kc,{uri:Z,width:A,height:A/($.width/$.height)},Z)}),$&&4===$.samples&&!R&&(0,F.jsx)(p.B,{flex:1,justifyContent:"center",children:(0,F.jsxs)(u.x,{templateColumns:"repeat(2, 1fr)",gap:6,children:[(0,F.jsx)(m.Kc,{uri:q,width:he/2,height:he/($.width/$.height)/2},1),(0,F.jsx)(m.Kc,{uri:ee,width:he/2,height:he/($.width/$.height)/2},2),(0,F.jsx)(m.Kc,{uri:se,width:he/2,height:he/($.width/$.height)/2},3),(0,F.jsx)(m.Kc,{uri:ae,width:he/2,height:he/($.width/$.height)/2},4)]})}),$&&4===$.samples&&R&&(0,F.jsx)(p.B,{flex:1,justifyContent:"center",children:(0,F.jsxs)(l.z,{spacing:1,children:[(0,F.jsx)(p.B,{w:"10%",children:(0,F.jsxs)(u.x,{templateColumns:"repeat(1, 1fr)",gap:6,children:[(0,F.jsx)(m.Kc,{isActive:Z===q,uri:q,width:.2*he/2,height:.2*he/($.width/$.height)/2,onPress:()=>{Y(q)}},1),(0,F.jsx)(m.Kc,{isActive:Z===ee,uri:ee,width:.2*he/2,height:.2*he/($.width/$.height)/2,onPress:()=>{Y(ee)}},2),(0,F.jsx)(m.Kc,{isActive:Z===se,uri:se,width:.2*he/2,height:.2*he/($.width/$.height)/2,onPress:()=>{Y(se)}},3),(0,F.jsx)(m.Kc,{isActive:Z===ae,uri:ae,width:.2*he/2,height:.2*he/($.width/$.height)/2,onPress:()=>{Y(ae)}},4)]})}),(0,F.jsx)(p.B,{w:"90%",children:(0,F.jsx)(m.Kc,{uri:Z,width:.8*he,height:.8*he/($.width/$.height)},Z)})]})})]}),(0,F.jsx)(p.B,{pb:2,spacing:4,justifyContent:"center",w:"full",backgroundColor:"black",maxW:"500px",children:(0,F.jsxs)(l.z,{spacing:2,children:[(0,F.jsx)(g.$,{py:4,my:4,colorScheme:"purple",borderRadius:"full",onClick:ne,leftIcon:(0,F.jsx)(w.I,{as:j.aO_}),flex:1,children:(0,F.jsx)(l.z,{children:(0,F.jsx)(d.E,{color:"white",fontSize:16,fontWeight:"700",children:E(N.P.dashboard.re_create)})})}),(0,F.jsx)(g.$,{flex:1,py:4,mx:2,my:4,colorScheme:"blue",borderRadius:"full",onClick:ce,leftIcon:(0,F.jsx)(w.I,{as:S.gWm}),children:(0,F.jsx)(l.z,{children:(0,F.jsx)(d.E,{color:"white",fontSize:16,fontWeight:"700",children:E(N.P.dashboard.save)})})})]})})]}),(0,F.jsx)(b.s,{isOpen:U,onClose:()=>G(!U),onPressPay:()=>{G(!1),Q(!0)},onPressAds:()=>{G(!1),oe({isFree:!0})}}),(0,F.jsx)(x.QV,{isOpen:J,onClose:()=>{Q(!1)}}),(0,F.jsx)(x.aj,{isOpen:B})]})})]})}}}]);