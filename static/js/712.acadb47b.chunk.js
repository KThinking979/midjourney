"use strict";(self.webpackChunkemojifi=self.webpackChunkemojifi||[]).push([[712],{712:(e,t,a)=>{a.d(t,{kg:()=>y,Dn:()=>f,Ww:()=>p,Zt:()=>x,Y_:()=>m,Vo:()=>g,wz:()=>b,FH:()=>H,Ip:()=>_,Y4:()=>A,bF:()=>h,TK:()=>w,jH:()=>u});var o=a(6220),n=a(815),r=a(9751);const s=(0,n.Wp)({apiKey:"AIzaSyBOTVOdSu20rXHX_VWHnV3XmS9ZcnfQuBQ",authDomain:"midjourneyai-71161.firebaseapp.com",projectId:"midjourneyai-71161",storageBucket:"midjourneyai-71161.appspot.com",messagingSenderId:"559017193613",appId:"1:559017193613:web:8f4159f592c0a63e4e32c4",measurementId:"G-FEN6H6F61Y"}),c=(0,o.aU)(s),l=(0,r.c7)(s);var i=a(4456),d=a(7385);const u=async e=>{let{name:t,data:a,folder:o="INPUT"}=e,n="";const s="".concat(o,"/").concat(t),c=(0,r.KR)(l,s);return await(0,r.ls)(c,a,"data_url"),n=await(0,r.qk)(c),n},p=async e=>{let{url:t}=e;try{const e=t,a=(0,r.KR)(l,e);return await(0,r.XR)(a),!0}catch(a){console.log("Error deleteFile ",a)}},m=async()=>{try{let e;const t=(0,o.H9)(c,"configs","configs"),a=await(0,o.x7)(t);return a.exists()&&(e=a.data()),e}catch(e){console.error("Error getUser: ",e)}},g=async()=>{try{let e;const t=(0,o.H9)(c,"configs","listAIStyle"),a=await(0,o.x7)(t);return a.exists()&&(e=a.data()),e}catch(e){console.error("Error listAIStyle: ",e)}},y=async e=>{let{id:t,username:a,coins:n}=e;try{const e=(new Date).toISOString().slice(0,10).replace("-","").replace("-","");await(0,o.BN)((0,o.H9)(c,"users","".concat(t)),{id:"".concat(t),username:a,coins:n,numAds:1,expDateAds:e,language:"en",createdAt:new Date,updateAt:new Date}),await(0,o.BN)((0,o.H9)(c,"albums","".concat(t)),{albums:[]})}catch(r){console.error("Error createUser: ",r)}},h=async e=>{let{id:t,coins:a,transactionId:n}=e;try{await(0,o.mZ)((0,o.H9)(c,"users","".concat(t)),{coins:a,updateAtTrans:"COIN_".concat(new Date),transactionId:"".concat(n)})}catch(r){console.error("Error updateCoinsUser: ",r)}},w=async e=>{let{id:t,coins:a,language:n,numAds:r,numAdsGen:s,expDateAds:l,updatedAt:i}=e;try{let e={};n&&(e={...e,language:n}),null!==a&&void 0!==a&&(e={...e,coins:a}),null!==r&&void 0!==r&&(e={...e,numAds:r}),null!==s&&void 0!==s&&(e={...e,numAdsGen:s}),null!==l&&void 0!==l&&(e={...e,expDateAds:l}),await(0,o.mZ)((0,o.H9)(c,"users","".concat(t)),{...e,updateAt:i||new Date})}catch(d){console.error("Error updateCoinsUser: ",d)}},A=async e=>{let{id:t,data:a}=e;try{await(0,o.mZ)((0,o.H9)(c,"albums","".concat(t)),{albums:(0,o.hq)(a)})}catch(n){console.error("Error updateAlbumAccount: ",n)}},f=async e=>{let{id:t,data:a}=e;try{await(0,o.mZ)((0,o.H9)(c,"albums","".concat(t)),{albums:(0,o.C3)(a)})}catch(n){console.error("Error deleteAlbum: ",n)}},x=async e=>{let{id:t,cursor:a}=e;try{let e=[];const a=(0,o.H9)(c,"albums","".concat(t)),n=await(0,o.x7)(a);return n.exists()&&(e=n.data()),e.albums}catch(n){console.error("Error getAlbums: ",n)}},b=async e=>{try{let t;const a=(0,o.H9)(c,"users","".concat(e)),n=await(0,o.x7)(a);return n.exists()&&(t=n.data()),t}catch(t){console.error("Error getUser: ",t)}},H=async e=>{let{model:t,server:a,text:o,cursor:n}=e;try{"".concat(window.location.protocol,"//").concat(a);const e=new Headers;e.append("Content-Type","application/json"),e.append("Accept","application/json, text/plain, */*"),e.append("Accept-Language","en-US,en;q=0.9"),e.append("Referer","https://lexica.art/");return i.Ze}catch(r){return console.log("Kai Error ",r),{error:!0}}},_=async e=>{let{server:t,token:a,textKey:o,negativeKey:n,steps:r,width:s,height:c,scale:l,seed:i,samples:u,samplerIndex:p,model:m,isControl:g,controlNets:y,isUpHD:h}=e;try{const e="".concat(t,"/txt2img"),w=new Headers;w.append("Authorization","Bearer ".concat(a)),w.append("content-type","application/json"),w.append("accept","application/json"),console.log("ADDRESS ",e),console.log("textKey ",o),console.log("negativeKey ",n),console.log("steps ",r),console.log("width ",s),console.log("height ",c),console.log("scale ",l),console.log("seed ",i),console.log("samples ",u),console.log("modelName ",m),console.log("samplerIndex ",p),console.log("isUpHD ",h),console.log("isControl ",g),console.log("controlNets ",y);let A={extra:{enable_nsfw_detection:!1},prompt:o,negative_prompt:n,sampler_name:p||"Euler a",batch_size:u||1,steps:r,cfg_scale:l,seed:i||-1,width:s,height:c,model_name:m||"anyhentai_20_31826.safetensors"};g&&(A={...A,alwayson_scripts:{controlnet:{args:[...y]}}}),h&&(A={...A,enable_hr:!0,hr_upscaler:"R-ESRGAN 4x+",hr_scale:2});const f=await fetch(e,{method:"POST",headers:w,body:JSON.stringify(A)});if(200!==f.status)return console.log("Error ",await f.text()),{error:!0};const x=(await f.json()).data.task_id;let b,H="",_=0;for(;_<3600;){const e=await fetch("".concat(t,"/progress?task_id=").concat(x),{method:"GET",headers:w});if(b=await e.json(),2===b.data.status&&b.data.imgs.length){H=b.data.imgs[0];break}await(0,d.yy)(1e3),_++}return{data:H,isSuccess:!0}}catch(w){return console.log("Error ",w),{error:!0}}}},7385:(e,t,a)=>{a.d(t,{RZ:()=>n,Sk:()=>r,yy:()=>o});const o=e=>new Promise((t=>setTimeout(t,e))),n=e=>{let{min:t,max:a}=e;return Math.floor(Math.random()*(a-t+1))+t},r=e=>new Promise(((t,a)=>{const o=new FileReader;o.onloadend=()=>t(o.result),o.readAsDataURL(e)}))}}]);