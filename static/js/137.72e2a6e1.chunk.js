"use strict";(self.webpackChunkemojifi=self.webpackChunkemojifi||[]).push([[137],{1940:(e,t,n)=>{n.d(t,{M:()=>i});const i=(0,n(4451).j)((()=>n.e(465).then(n.bind(n,465))),(e=>e.ImageFast))},4137:(e,t,n)=>{n.r(t),n.d(t,{AlbumPage:()=>x});var i=n(9950),r=n(6455),o=n(3247),a=n(7981),s=n(4456),c=n(2238),l=n(712),u=n(7385),p=n(6256),m=n(1940),d=n(4414);let h=window.innerWidth>500?500:window.innerWidth;window.innerHeight;const f={lexicaSearch:"https://lexica.art/api/infinite-prompts",lexicaImageSm2:"https://image.lexica.art/sm2",modelLexica:"lexica-aperture-v3.5",limitSearch:1e3},x=()=>{const{faceEmo:e,user:t}=(0,i.useContext)(c.j8),{setFaceEmo:n,setUser:x}=(0,i.useContext)(c.LN),[g,w]=(0,i.useState)(!0),[v,y]=(0,i.useState)(!1),[S,C]=(0,i.useState)(!0),[j,E]=(0,i.useState)(0),[b,L]=(0,i.useState)([]),[F,_]=(0,i.useState)([]),[k,T]=(0,i.useState)([]),[A,P]=(0,i.useState)([]),H=async e=>{let{isFirst:t,_textKey:n,_cursor:i}=e;if(!v&&i<=f.limitSearch){y(!0);let e=await(0,l.FH)({server:f&&f.lexicaSearch?f.lexicaSearch:"https://lexica.art/api/infinite-prompts",model:f&&f.modelLexica?f.modelLexica:"lexica-aperture-v2",text:n,cursor:i});if(e&&e.prompts&&0===e.prompts.length&&(e=await(0,l.FH)({server:f&&f.lexicaSearch?f.lexicaSearch:"https://lexica.art/api/infinite-prompts",model:f&&f.modelLexica?f.modelLexica:"lexica-aperture-v2",text:n,cursor:i})),e&&e.prompts&&0===e.prompts.length&&(e=await(0,l.FH)({server:f&&f.lexicaSearch?f.lexicaSearch:"https://lexica.art/api/infinite-prompts",model:f&&f.modelLexica?f.modelLexica:"lexica-aperture-v2",text:n,cursor:i})),e&&e.prompts&&0===e.prompts.length&&(e=await(0,l.FH)({server:f&&f.lexicaSearch?f.lexicaSearch:"https://lexica.art/api/infinite-prompts",model:f&&f.modelLexica?f.modelLexica:"lexica-aperture-v2",text:n,cursor:i})),e&&e.prompts&&e.prompts.length){const{prompts:t}=e,n=[];for(let e=0;e<t.length;e++){const i=t[e];n.push({id:i.id,textKey:i.prompt,negativeKey:i.negativePrompt?i.negativePrompt:"",uri:i.images.length?"".concat(f.lexicaImageSm2,"/").concat(i.images[0].id):"",width:i.width,height:i.height,isLast:e===t.length-1?b.length+t.length:0})}console.log("Kai Art ",n.length),L([...b,...n]),E(i+50),i+50===f.limitSearch&&C(!1)}else L([]);!g&&await(0,u.y)(1e3),y(!1)}};(0,i.useEffect)((()=>{(async()=>{T(s.$7),P(s.rv),_(s.M3),await H({isFirst:!1,_textKey:"",_cursor:0}),window.scrollTo(0,0)})(),(async()=>{var e;const n=null===(e=window.Telegram)||void 0===e?void 0:e.WebApp;if(n&&!t){n.ready();const e=n.initDataUnsafe.user;if(e){let t={id:e.id,username:"".concat(e.last_name," ").concat(e.first_name),emoFiCoins:0};const n=await(0,l.wz)(t.id);n?t={...t,emoFiCoins:n.emoFiCoins}:await(0,l.kg)(t),x(t)}}})()}),[]);const O=(0,i.useCallback)((async()=>{const{scrollTop:e,scrollHeight:t,clientHeight:n}=document.documentElement;e+n>=t-.5&&await H({isFirst:!1,_textKey:"",_cursor:0})}),[b]);return(0,i.useEffect)((()=>(window.addEventListener("scroll",O),()=>window.removeEventListener("scroll",O))),[O]),console.log("Arts ",b.length),(0,d.jsxs)(o.az,{children:[(0,d.jsxs)(r.mg,{children:[(0,d.jsx)("title",{children:"Album"}),(0,d.jsx)("meta",{name:"description",content:"Midjourney AI"})]}),(0,d.jsx)(a.B,{h:"100vh",w:h,py:20,px:2,spacing:10,children:(0,d.jsx)(a.B,{padding:0,py:4,pb:40,onScroll:O,children:(0,d.jsx)(p.A,{columnsCount:2,gutter:"16px",children:b.map(((e,t)=>{const{id:n,uri:i}=e;return(0,d.jsx)(m.M,{uri:i},t)}))})})})]})}},7385:(e,t,n)=>{n.d(t,{y:()=>i});const i=e=>new Promise((t=>setTimeout(t,e)))},6256:(e,t,n)=>{n.d(t,{A:()=>p});var i=n(9950);function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},r.apply(this,arguments)}function o(e,t){return o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},o(e,t)}var a=function(e){var t,n;function a(){return e.apply(this,arguments)||this}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,o(t,n);var s=a.prototype;return s.getColumns=function(){var e=this.props,t=e.children,n=e.columnsCount,r=Array.from({length:n},(function(){return[]})),o=0;return i.Children.forEach(t,(function(e){e&&i.isValidElement(e)&&(r[o%n].push(e),o++)})),r},s.renderColumns=function(){var e=this.props,t=e.gutter,n=e.itemTag,o=e.itemStyle;return this.getColumns().map((function(e,a){return i.createElement(n,{key:a,style:r({display:"flex",flexDirection:"column",justifyContent:"flex-start",alignContent:"stretch",flex:1,width:0,gap:t},o)},e.map((function(e){return e})))}))},s.render=function(){var e=this.props,t=e.gutter,n=e.className,o=e.style,a=e.containerTag;return i.createElement(a,{style:r({display:"flex",flexDirection:"row",justifyContent:"center",alignContent:"stretch",boxSizing:"border-box",width:"100%",gap:t},o),className:n},this.renderColumns())},a}(i.Component);a.propTypes={},a.defaultProps={columnsCount:3,gutter:"0",className:null,style:{},containerTag:"div",itemTag:"div",itemStyle:{}};const s=a;var c="undefined"!==typeof window?i.useLayoutEffect:i.useEffect,l=function(){var e=function(){var e=(0,i.useState)(!1),t=e[0],n=e[1];return c((function(){n(!0)}),[]),t}(),t=(0,i.useState)("undefined"!==typeof window?window.innerWidth:0),n=t[0],r=t[1],o=(0,i.useCallback)((function(){e&&r(window.innerWidth)}),[e]);return c((function(){if(e)return window.addEventListener("resize",o),o(),function(){return window.removeEventListener("resize",o)}}),[e,o]),n},u=function(e){var t=e.columnsCountBreakPoints,n=void 0===t?{350:1,750:2,900:3}:t,r=e.children,o=e.className,a=void 0===o?null:o,s=e.style,c=void 0===s?null:s,u=l(),p=(0,i.useMemo)((function(){var e=Object.keys(n).sort((function(e,t){return e-t})),t=e.length>0?n[e[0]]:1;return e.forEach((function(e){e<u&&(t=n[e])})),t}),[u,n]);return i.createElement("div",{className:a,style:c},i.Children.map(r,(function(e,t){return i.cloneElement(e,{key:t,columnsCount:p})})))};u.propTypes={};const p=s}}]);