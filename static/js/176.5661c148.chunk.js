"use strict";(self.webpackChunkmidjourney=self.webpackChunkmidjourney||[]).push([[176],{1940:(e,t,s)=>{s.d(t,{Kc:()=>o,MF:()=>a,ay:()=>n,nn:()=>r});var i=s(4451);const a=(0,i.j)((()=>s.e(465).then(s.bind(s,465))),(e=>e.ImageFast)),r=(0,i.j)((()=>s.e(9606).then(s.bind(s,9606))),(e=>e.ImageSkeleton)),o=(0,i.j)((()=>s.e(2613).then(s.bind(s,2613))),(e=>e.ImageSkeletonShow)),n=(0,i.j)((()=>s.e(8977).then(s.bind(s,8977))),(e=>e.ImageSkeletonFace))},176:(e,t,s)=>{s.r(t),s.d(t,{ModalGenArt:()=>A});var i=s(9950),a=s(2099),r=s(4521),o=s(2463),n=s(2505),c=s(4787),h=s(3247),l=s(4418),w=s(393),d=s(1317),y=s(6569),p=s(1389),u=s(2481),g=s(1374),v=s(5236),x=s(3246),m=s(1940),S=s(5495),f=s(712),k=s(4456),j=s(9591),K=s(7385),I=s(3124),_=s(7956),b=s(2096),C=s(4414);let N=window.innerWidth>500?500:window.innerWidth,F=!1;const A=e=>{let{isOpen:t,onClose:A,dataAI:W}=e;const D=(0,a.d)(),{user:T,configs:E}=(0,i.useContext)(v.rf),{setUser:H}=(0,i.useContext)(v.D8),[P,L]=(0,i.useState)(!1),[z,R]=(0,i.useState)(!1),[O,V]=(0,i.useState)(!1),[B,U]=(0,i.useState)(!1),[G,J]=(0,i.useState)(),[Q,$]=(0,i.useState)(""),[M,Z]=(0,i.useState)(""),[Y,q]=(0,i.useState)(""),[X,ee]=(0,i.useState)(""),[te,se]=(0,i.useState)("");(0,i.useEffect)((()=>{window.scrollTo(0,0),T&&W&&t&&ie({isFree:W.isFree})}),[W,t]);const ie=async e=>{let t,{isFree:s}=e;F=!1;let i=0;try{if(T&&W){const e=T;L(!0),R(!1),J(W),$(""),Z(""),q(""),ee(""),se("");const a=W.style?W.style.key:"";let r="".concat(a.replace("{prompt}",W.prompt));const o=W.style?W.style.negativeKey:"",n="".concat(W.negativeKey," ").concat(o);if(s||!s&&parseFloat(e.coins)>=parseFloat(W.feeCoin))for(let s=0;s<W.samples&&!F;s++){let e=W.seed;if(-1===W.seed&&(e=(0,K.RZ)({min:0,max:k.Vm})),W.type===k.Wk.GEN_SD3){const s={...W,stylePreset:W.style.stylePreset,aspectRatio:W.aspectRatio.title,seed:e,textKey:r,negativeKey:n,token:E.token,server:E.serverSD3};t=await(0,f.DS)(s),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.DS)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.DS)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.DS)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=W.isText?await(0,f.Ip)({...W,seed:e,steps:20*W.steps/30,width:W.width,height:W.height,model:"dreamshaper_8_93211.safetensors",textKey:r,negativeKey:n,isHD:!1,token:E.tokenNov,server:E.serverNov}):await(0,f.Ip)({...W,base64:"",seed:e,steps:20*W.steps/30,width:W.width,height:W.height,model:"dreamshaper_8_93211.safetensors",textKey:r,negativeKey:n,isHD:!1,token:E.tokenNov,server:E.serverNov})),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),W.isText,t=await(0,f.Ip)({...W,seed:e,steps:20*W.steps/30,width:W.width,height:W.height,model:"dreamshaper_8_93211.safetensors",textKey:r,negativeKey:n,isHD:!0,token:E.tokenNov,server:E.serverNov}))}if(W.type===k.Wk.GEN_CORE){const s={...W,stylePreset:W.style.stylePreset,aspectRatio:W.aspectRatio.title,seed:e,textKey:r,negativeKey:n,token:E.token,server:E.serverSD3};t=await(0,f.Kh)(s),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.Kh)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.Kh)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.Kh)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=W.isText?await(0,f.Ip)({...W,seed:e,steps:20*W.steps/30,width:W.width,height:W.height,model:"dreamshaper_8_93211.safetensors",textKey:r,negativeKey:n,isHD:!1,token:E.tokenNov,server:E.serverNov}):await(0,f.Ip)({...W,base64:"",seed:e,steps:20*W.steps/30,width:W.width,height:W.height,model:"dreamshaper_8_93211.safetensors",textKey:r,negativeKey:n,isHD:!1,token:E.tokenNov,server:E.serverNov})),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),W.isText,t=await(0,f.Ip)({...W,seed:e,steps:20*W.steps/30,width:W.width,height:W.height,model:"dreamshaper_8_93211.safetensors",textKey:r,negativeKey:n,isHD:!0,token:E.tokenNov,server:E.serverNov}))}if(W.type===k.Wk.GEN_ULTRA){const s={...W,stylePreset:W.style.stylePreset,aspectRatio:W.aspectRatio.title,seed:e,textKey:r,negativeKey:n,token:E.token,server:E.serverSD3};t=await(0,f.jV)(s),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.jV)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.jV)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.jV)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=W.isText?await(0,f.Ip)({...W,seed:e,steps:20*W.steps/30,width:W.width,height:W.height,model:"dreamshaper_8_93211.safetensors",textKey:r,negativeKey:n,isHD:!1,token:E.tokenNov,server:E.serverNov}):await(0,f.Ip)({...W,base64:"",seed:e,steps:20*W.steps/30,width:W.width,height:W.height,model:"dreamshaper_8_93211.safetensors",textKey:r,negativeKey:n,isHD:!1,token:E.tokenNov,server:E.serverNov})),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),W.isText,t=await(0,f.Ip)({...W,seed:e,steps:20*W.steps/30,width:W.width,height:W.height,model:"dreamshaper_8_93211.safetensors",textKey:r,negativeKey:n,isHD:!0,token:E.tokenNov,server:E.serverNov}))}if(W.type===k.Wk.GEN&&"ProGen"===W.model){const s={...W,stylePreset:W.style.stylePreset,seed:e,textKey:r,negativeKey:n,token:E.token,server:E.server};t=W.isText?await(0,f.F)(s):await(0,f.fO)(s),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=W.isText?await(0,f.F)(s):await(0,f.fO)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=W.isText?await(0,f.F)(s):await(0,f.fO)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=W.isText?await(0,f.F)(s):await(0,f.fO)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=W.isText?await(0,f.Ip)({...W,seed:e,steps:20*W.steps/30,width:W.width,height:W.height,model:"dreamshaper_8_93211.safetensors",textKey:r,negativeKey:n,isHD:!0,token:E.tokenNov,server:E.serverNov}):await(0,f.Ip)({...W,base64:"",seed:e,steps:20*W.steps/30,width:W.width,height:W.height,model:"dreamshaper_8_93211.safetensors",textKey:r,negativeKey:n,isHD:!0,token:E.tokenNov,server:E.serverNov})),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),W.isText,t=await(0,f.Ip)({...W,seed:e,steps:20*W.steps/30,width:W.width,height:W.height,model:"dreamshaper_8_93211.safetensors",textKey:r,negativeKey:n,isHD:!1,token:E.tokenNov,server:E.serverNov}))}if(W.type===k.Wk.GEN&&"ProGen"!==W.model){const s={...W,seed:e,steps:20*W.steps/30,width:W.width,height:W.height,textKey:r,negativeKey:n,token:E.tokenNov,server:E.serverNov};t=W.isText?await(0,f.Ip)(s):await(0,f.EQ)(s),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=W.isText?await(0,f.Ip)(s):await(0,f.EQ)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=W.isText?await(0,f.Ip)(s):await(0,f.EQ)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=W.isText?await(0,f.Ip)(s):await(0,f.EQ)(s))}if(W.type===k.Wk.ILLUSION){const s={...W,seed:e,steps:20*W.steps/30,width:W.width,height:W.height,textKey:r,negativeKey:n,token:E.tokenNov,server:E.isIllusionV3?E.serverNov3:E.serverNov};t=E.isIllusionV3?await(0,f.aB)(s):await(0,f.v7)(s),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=E.isIllusionV3?await(0,f.aB)(s):await(0,f.v7)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=E.isIllusionV3?await(0,f.aB)(s):await(0,f.v7)(s)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=E.isIllusionV3?await(0,f.aB)(s):await(0,f.v7)(s))}if(W.type===k.Wk.FACE_SWAP){let e;const s=await(0,f.jH)({data:W.base64,folder:"input",name:(0,_.A)(),isUrl:!!Q.includes("http")});W.image.url=s,"Custom"===W.style.title&&(e=await(0,f.jH)({data:W.style.base64,folder:"input",name:(0,_.A)(),isUrl:!!Q.includes("http")}),W.style.url=e);const i={...W,swapImage:{...W.image},baseImage:{url:W.style.url},token:E.tokenFAL,server:E.serverFAL};t=await(0,f.W_)(i),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.W_)(i)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.W_)(i)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.W_)(i)),s&&(0,f.Ww)({url:s}),e&&(0,f.Ww)({url:e})}if(W.type===k.Wk.FACE_STICKER){const e=(0,_.A)(),s=await(0,f.jH)({data:W.base64,folder:"input",name:e,isUrl:!!Q.includes("http")});W.image.url=s;const i={...W,token:E.tokenFAL,server:E.serverFAL};t=await(0,f.eL)(i),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.eL)(i)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.eL)(i)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.eL)(i)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.eL)(i)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.eL)(i)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.eL)(i)),(0,f.Ww)({url:s})}if(W.type===k.Wk.UPSCALE){const s=(0,_.A)();let i=await(0,f.ZJ)({file:W.image,width:540,height:540});const a=await(0,K.Sk)(i);W.base64=a;const r=await(0,f.jH)({data:W.base64,folder:"input",name:s,isUrl:!!Q.includes("http")});W.image.url=r;const o={...W,seed:e,textKey:W.prompt,negativeKey:W.negative,token:E.tokenFAL,server:E.serverFAL};"Esrgan"===W.style.name&&(t=await(0,f.J3)(o),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.J3)(o)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.J3)(o)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.J3)(o))),"Ccsr"===W.style.name&&(t=await(0,f.ym)(o),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.ym)(o)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.ym)(o)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.ym)(o))),"Clarity"===W.style.name&&(t=await(0,f.rj)(o),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.rj)(o)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.rj)(o)),!t.error&&t.isSuccess||(await(0,K.yy)(1e3),t=await(0,f.rj)(o))),(0,f.Ww)({url:r})}if(t&&!t.error){if(0===s&&$(t.data),4===W.samples)switch(s){case 0:Z(t.data);break;case 1:q(t.data);break;case 2:ee(t.data);break;case 3:se(t.data)}t.isSuccess&&(i+=parseFloat(W.feeCoin)/W.samples)}}if(L(!1),s){const e=(new Date).toUTCString(),t="".concat(T.dateAds,"_").concat(W.mode,"_ADS_V1_").concat(e);(0,f.TK)({id:T.id,updatedAt:t})}else{const t=parseFloat(e.coins)-i,s=(new Date).toUTCString(),a="".concat(e.coins,"-").concat(i,"=").concat(t,"_Gen_V1_IOS_").concat(s);null===t&&void 0===t||(await(0,f.TK)({id:T.id,coins:t<0?0:t,updatedAt:a}),H({...T,coins:t<0?0:t}))}R(!0)}else A&&A()}catch(a){console.log("Error ",a),L(!1)}},ae=(0,i.useCallback)((async()=>{T&&(parseFloat(T.coins)>=parseFloat(G.feeCoin)?ie({isFree:!1}):parseFloat(G.feeCoin)>5?A&&A():V(!0))}),[T,G]),re=(0,i.useCallback)((async()=>{if(T)try{L(!0);const e=(0,_.A)(),t=await(0,f.jH)({data:Q,folder:"albums",name:e,isUrl:!!Q.includes("http")}),s={id:e,userId:T.id,type:G.type,isImage:!0,prompt:G.prompt,negative:G.negative,style:G.type.includes("GEN")?G.style.title:"None",width:G.width,height:G.height,steps:G.steps,scale:G.scale,uri:t};await(0,f.Y4)({id:e,data:s}),D({title:"Saved",status:"success",position:"bottom",isClosable:!0,duration:2e3}),L(!1)}catch(e){L(!1)}}),[G,Q]),oe=N;return(0,C.jsxs)(r.aF,{onClose:A,isOpen:t,size:"full",children:[(0,C.jsx)(o.m,{backgroundColor:"black"}),(0,C.jsx)(n.$,{backgroundColor:"black",zIndex:9999,children:(0,C.jsxs)(c.c,{p:0,backgroundColor:"black",children:[(0,C.jsx)(h.az,{transition:"0.9s ease",pos:"fixed",top:0,w:"full",zIndex:999,children:(0,C.jsxs)(l.z,{flex:1,p:2,justifyContent:"space-between",w:"full",minH:"40px",children:[(0,C.jsx)(w.I,{as:b.m6W,boxSize:7,padding:0,color:"white",zIndex:999,onClick:()=>{A&&A()}}),(0,C.jsxs)(l.z,{alignItems:"center",justifyContent:"center",children:[(0,C.jsx)(d.E,{fontSize:"18px",fontWeight:500,lineHeight:"17px",letterSpacing:"0.5px",color:"white",textAlign:"center",children:T&&T.coins?(new Intl.NumberFormat).format(T.coins):0}),(0,C.jsx)(y._,{borderRadius:"full",boxSize:"20px",src:s(2975),alt:"coin"})]})]})}),(0,C.jsxs)(p.B,{h:"100vh",w:N,pt:20,px:2,justifyContent:"space-between",children:[(0,C.jsxs)(p.B,{flex:1,children:[G&&1===G.samples&&(0,C.jsx)(p.B,{flex:1,justifyContent:"center",children:(0,C.jsx)(m.Kc,{uri:Q,width:N,height:N/(G.width/G.height)},Q)}),G&&4===G.samples&&!z&&(0,C.jsx)(p.B,{flex:1,justifyContent:"center",children:(0,C.jsxs)(u.x,{templateColumns:"repeat(2, 1fr)",gap:6,children:[(0,C.jsx)(m.Kc,{uri:M,width:oe/2,height:oe/(G.width/G.height)/2},1),(0,C.jsx)(m.Kc,{uri:Y,width:oe/2,height:oe/(G.width/G.height)/2},2),(0,C.jsx)(m.Kc,{uri:X,width:oe/2,height:oe/(G.width/G.height)/2},3),(0,C.jsx)(m.Kc,{uri:te,width:oe/2,height:oe/(G.width/G.height)/2},4)]})}),G&&4===G.samples&&z&&(0,C.jsx)(p.B,{flex:1,justifyContent:"center",children:(0,C.jsxs)(l.z,{spacing:1,children:[(0,C.jsx)(p.B,{w:"10%",children:(0,C.jsxs)(u.x,{templateColumns:"repeat(1, 1fr)",gap:6,children:[(0,C.jsx)(m.Kc,{isActive:Q===M,uri:M,width:.2*oe/2,height:.2*oe/(G.width/G.height)/2,onPress:()=>{$(M)}},1),(0,C.jsx)(m.Kc,{isActive:Q===Y,uri:Y,width:.2*oe/2,height:.2*oe/(G.width/G.height)/2,onPress:()=>{$(Y)}},2),(0,C.jsx)(m.Kc,{isActive:Q===X,uri:X,width:.2*oe/2,height:.2*oe/(G.width/G.height)/2,onPress:()=>{$(X)}},3),(0,C.jsx)(m.Kc,{isActive:Q===te,uri:te,width:.2*oe/2,height:.2*oe/(G.width/G.height)/2,onPress:()=>{$(te)}},4)]})}),(0,C.jsx)(p.B,{w:"90%",children:(0,C.jsx)(m.Kc,{uri:Q,width:.8*oe,height:.8*oe/(G.width/G.height)},Q)})]})})]}),(0,C.jsx)(p.B,{pb:2,spacing:4,justifyContent:"center",w:"full",backgroundColor:"black",maxW:"500px",children:(0,C.jsxs)(l.z,{spacing:2,children:[(0,C.jsx)(g.$,{py:4,my:4,colorScheme:"purple",borderRadius:"full",onClick:ae,leftIcon:(0,C.jsx)(w.I,{as:j.aO_}),flex:1,children:(0,C.jsx)(l.z,{children:(0,C.jsx)(d.E,{color:"white",fontSize:16,fontWeight:"700",children:"Re-Create"})})}),(0,C.jsx)(g.$,{flex:1,py:4,mx:2,my:4,colorScheme:"blue",borderRadius:"full",onClick:re,leftIcon:(0,C.jsx)(w.I,{as:S.gWm}),children:(0,C.jsx)(l.z,{children:(0,C.jsx)(d.E,{color:"white",fontSize:16,fontWeight:"700",children:"Save"})})})]})})]}),(0,C.jsx)(I.s,{isOpen:O,onClose:()=>V(!O),onPressPay:()=>{V(!1),U(!0)},onPressAds:()=>{V(!1),ie({isFree:!0})}}),(0,C.jsx)(x.QV,{isOpen:B,onClose:()=>{U(!1)}}),(0,C.jsx)(x.aj,{isOpen:P})]})})]})}}}]);